{"version":3,"sources":["app.module.js","app.routes.js","components/about/about.controller.js","components/account/account.controller.js","components/account/account.directive.js","components/admin/admin.controller.js","components/book-builder/bookBuilder.controller.js","components/book-builder/bookbuilder.directive.js","components/cart/cart.controller.js","components/home/home.controller.js","components/home/howItWorks.directive.js","components/home/parallax.directive.js","components/prints/prints.controller.js","components/start/start.controller.js","shared/directives/bgImg.directive.js","shared/modals/alertModalCtrl.js","shared/services/address.service.js","shared/services/admin.service.js","shared/services/auth.service.js","shared/services/book.service.js","shared/services/cart.service.js","shared/services/cleanseCart.service.js","shared/services/modal.service.js","shared/services/product.service.js","shared/services/renderHTML.filter.js","shared/services/s3.service.js","shared/services/stripe.service.js","shared/services/user.service.js","components/admin/archive/adminArchive.controller.js","components/admin/order-details/orderDetails.controller.js","components/admin/orders/adminOrders.controller.js","components/admin/orders-table/ordersTable.directive.js","components/admin/orders-table/ordersTableDirective.controller.js","components/admin/page-products/adminPageProducts.controller.js","components/admin/print-products/adminPrintProducts.controller.js","components/admin/product-table/productTable.directive.js","components/admin/product-table/productTableDirective.controller.js","components/book-builder/project-view-modal/projectModalController.js","components/cart/cart-directive/cart.directive.js","components/cart/cart-directive/cartDirective.controller.js","components/cart/payment-modal/payment-modal.controller.js","shared/directives/build-page/animateFadeDir.js","shared/directives/build-page/bbImgSlider.directive.js","shared/directives/footer/footer.directive.js","shared/directives/modal/modal.controller.js","shared/directives/modal/modal.directive.js","shared/directives/nav/nav.controller.js","shared/directives/nav/nav.directive.js","shared/directives/page/pageDir.js","shared/directives/page/pageDirCtrl.js","shared/directives/payment/modal-trigger.directive.js","shared/directives/payment/stripe-directive.js","shared/directives/payment/stripe.controller.js","shared/directives/prints-dropdown/printsDropdown.controller.js","shared/directives/prints-dropdown/printsDropdown.directive.js","shared/directives/s3-uploader/s3.controller.js","shared/directives/s3-uploader/s3.directive.js","shared/modals/delete-book-modal/deleteBookModalController.js","shared/modals/new-project-modal/newProjectModalCtrl.js","shared/modals/prints-modal/alertPrintModalCtrl.js","shared/modals/prints-modal/printsModalCtrl.js","shared/modals/review-modal/reviewModalCtrl.js","shared/modals/view-projects-modal/projectModalController.js","components/admin/order-details/order-details-book-directive/orderDetailsBook.directive.js","components/admin/order-details/order-details-book-directive/order-details-book-page-directive/orderDetailsBookPage.directive.js"],"names":["angular","module","config","run","scrollFix","$stateProvider","$urlRouterProvider","stripeProvider","setPublishableKey","when","getUser","$state","AuthService","checkUser","then","res","limitUser","go","catch","err","limitAdmin","privilege","state","url","controller","templateUrl","resolve","user","otherwise","$rootScope","$window","$on","scrollTo","aboutController","$scope","accountController","BookService","addressService","UserService","console","log","getUserBooks","_id","userBooks","getAddress","userAddress","updateUser","update","address","CreateAddress","undefined","postAddress","input","document","querySelectorAll","x","length","setAttribute","getAttribute","directive","accountDir","restrict","link","scope","elem","attrs","$","on","addClass","setTimeout","removeClass","adminController","ProductService","bookBuilderController","$uibModal","$timeout","bookService","modalService","CartService","saved","getActiveOrder","activeOrder","resetPages","pages","createNewBook","title","img","openAlertModal","addNewPage","book","title_img","currentBook","data","fillBookInfo","error","initialLoad","i","fillPage","push","text","page_type","activity_type","custom_activity","image_url","edit_allowed","page_number","updatePageNums","arr","removePage","splice","saveBook","openViewProjectsModal","m","result","message","deleted","openNewProjectModal","openReviewModal","modalInstance","open","animation","size","selectPrints","openPrintsModal","print_qty","saveToOrder","createNewOrder","bookArray","books","addBookToOrder","bookbuilderDir","toggleClass","html","select","keypress","e","which","focusout","cartController","showCart","defaultMessage","$watch","newVal","oldVal","messageHandler","userId","orderId","getOrderDetails","order","cart","homeController","howItWorks","imgUrl","desc","template","window","scroll","scrollTop","parallax","winScroll","css","printsController","$log","$document","test","startController","getProductByCategory","login","stateOption","goToState","category","response","pageTypes","bgImg","attr","alertModalCtrl","$uibModalInstance","cancel","close","confirm","service","$http","get","method","AdminService","getAllActiveOrders","getAllArchivedOrders","getOneOrderById","updateOrder","$location","logout","$emit","current","name","location","href","post","put","deleteBook","delete","CleanseCartService","bookId","bookArr","cleanseOrder","updateCart","updatedOrder","newOrderData","map","putShipAddress","shipping","ship_address","$q","resData","deferred","defer","asyncLoop","asyncFin","bookItem","pageProducts","subtotal","filter","product","quantity","countPageType","getSubtotals","forEach","price","promise","count","openDeleteBookModal","index","modalController","alertTitle","alertBody","cancelBtnCol","cancelBtnTxt","confirmBtnCol","confirmBtnTxt","getProductByName","getAllProducts","updateProduct","JSON","stringify","renderHTML","$sce","string","trustAsHtml","S3Service","uploadPhoto","photo","toJson","StripeService","stripe","adminArchiveController","Array","isArray","allOrders","orderDetailsController","$stateParams","id","abbreviatedId","abbreviateId","slice","adminOrdersController","ordersTable","toggleSwitch","filterPredicate","orderPredicate","bindToController","controllerAs","ctrl","ordersTableController","newValue","countTotalPages","total","page","toggleArchived","toggle","archived","archiveOrder","unarchiveOrder","adminPageProductsController","allProducts","adminPrintProductsController","productTable","productType","productTableController","submitProductChanges","projectModalController","checkBookLength","openBook","deletedIndex","newBookTitle","titleImg","cartTotal","removeItem","slideUp","cartDirectiveController","getCartTotal","pageProduct","openPaymentModal","param","paymentModalController","unique_order_id","ship_info","charge","card","createToken","payment","last4","copy","token","amount","type","alert","validateNumber","value","number","validateCardNumber","numberError","cardInfoForm","$setValidity","cardType","Stripe","validateExpiry","month","year","exp","expiryError","validateCVC","cvcError","cvc","animateFade","condition","bbImgSliderDir","transX","transXM","transTotal","checker","checkerM","lengthSaver","oldValue","is","resize","width","footerDirective","ok","modalDirective","navController","event","checkCartNum","cartNum","navDirective","bookPage","hasClass","pageDirCtrl","wasPageDeleted","activity_types","allowTypes","modalCtrl","cancelColor","cancelText","confirmColor","confirmText","$parent","htmlID","preventDefault","modal","model","payRent","chargeAmount","moment","getUserById","rentPaid","todayIsInTimeFrame","rentDueDate","needToPayRent","lateFees","calculateFees","totalRentAmount","rentAmount","payRentBank","bankAccount","country","currency","routing_number","accountInfo","routingNumber","account_number","accountNumber","account_holder_name","account_holder_type","status","chargeBank","email","addPaymentToUser","payRentCard","source","create","cardInfo","exp_month","exp_year","owner","postal_code","zip","chargeCard","date","Date","userid","incrementDueDate","dueDate","today","difference","diff","now","getMonth","getFullYear","printsDropdownController","prints","setSelection","option","printsSelection","printsDropdown","s3Controller","buttonText","submitPhoto","inputText","successText","s3Url","getElementById","blur","resizer","extension","maxWidth","maxHeight","photoToResize","Image","reader","FileReader","onload","onLoadEvent","src","target","MAX_WIDTH","MAX_HEIGHT","height","canvas","createElement","style","visibility","body","appendChild","ctx","getContext","drawImage","resizedPhotoBody","toDataURL","newImage","imageBody","imageExtension","readAsDataURL","s3Uploader","repeatId","defaultText","element","querySelector","onChangeEvent","imageData","split","files","deleteBookModalCtrl","preTitle","newProjectModalCtrl","alertPrintModalCtrl","printsModalCtrl","sendToCart","selectedPrints","reviewModalCtrl","viewProjectModalCtrl","deletedBooks","deletedbookId","orderDetailsBook","bookNumber","orderDetailsBookPage"],"mappings":"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","file":"../app_bundle.js","sourcesContent":["(function() {\n\n  angular\n    .module('app', ['ui.router', 'ui.bootstrap', 'ngAnimate', 'angular-stripe'])\n\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .config(['$stateProvider', '$urlRouterProvider', 'stripeProvider', config])\n    .run(['$rootScope', '$window', scrollFix]);\n\n  function config($stateProvider, $urlRouterProvider, stripeProvider) {\n\n    stripeProvider.setPublishableKey('pk_test_yN68NiS92cu5tu6yrxsKiyxu');\n\n    $urlRouterProvider.when('/admin', '/admin/orders');\n\n    let getUser = ($state, AuthService) => {\n      return AuthService.checkUser()\n        .then((res) => {\n          return res;\n        });\n    };\n\n    let limitUser = ($state, AuthService) => {\n      return AuthService.checkUser()\n        .then((res) => {\n          if (!res) $state.go('home');\n          return res;\n        })\n        .catch((err) => {\n          $state.go('home');\n        });\n    };\n\n    let limitAdmin = ($state, AuthService) => {\n      return AuthService.checkUser()\n        .then((res) => {\n          if (!res || res.privilege !== \"admin\") {\n            $state.go('home')\n          };\n          return res;\n        })\n        .catch((err) => {\n          $state.go('home');\n        });\n    };\n\n    $stateProvider\n      .state('home', {\n        url: '/home',\n        controller: 'homeController',\n        templateUrl: './app/components/home/home.html',\n        resolve: {\n          user: getUser\n        }\n      })\n      .state('about', {\n        url: '/about',\n        controller: 'aboutController',\n        templateUrl: './app/components/about/about.html',\n        resolve: {\n          user: getUser\n        }\n      })\n      .state('start', {\n        url: '/start',\n        templateUrl: './app/components/start/start.html',\n        controller: 'startController',\n        resolve: {\n          user: getUser\n        }\n      })\n      .state('book-builder', {\n        url: '/book-builder',\n        controller: 'bookBuilderController',\n        templateUrl: './app/components/book-builder/book-builder.html',\n        resolve: {\n          user: limitUser\n        }\n      })\n      .state('prints', {\n        url: '/prints',\n        controller: 'printsController',\n        templateUrl: './app/components/prints/prints.html',\n        resolve: {\n          user: limitUser\n        }\n      })\n      .state('cart', {\n        url: '/cart',\n        controller: 'cartController',\n        templateUrl: './app/components/cart/cart.html',\n        resolve: {\n          user: limitUser\n        }\n      })\n      .state('account', {\n        url: '/account',\n        controller: 'accountController',\n        templateUrl: './app/components/account/account.html',\n        resolve: {\n          user: limitUser\n        }\n      })\n      .state('sandbox', {\n        url: '/sandbox',\n        controller: 'sandboxController',\n        templateUrl: './app/components/sandbox/sandbox.html'\n      })\n      .state('admin', {\n        url: '/admin',\n        controller: 'adminController',\n        templateUrl: './app/components/admin/admin.html',\n        resolve: {\n          user: limitAdmin\n        }\n      })\n          .state('admin.page-products', {\n            url: '/page-products',\n            templateUrl: './app/components/admin/page-products/page-products.html',\n            controller: 'adminPageProductsController'\n          })\n          .state('admin.print-products', {\n            url: '/print-products',\n            templateUrl: './app/components/admin/print-products/print-products.html',\n            controller: 'adminPrintProductsController'\n          })\n          .state('admin.orders', {\n            url: '/orders',\n            templateUrl: './app/components/admin/orders/orders.html',\n            controller: 'adminOrdersController'\n          })\n          .state('admin.archive', {\n            url: '/archive',\n            templateUrl: './app/components/admin/archive/archive.html',\n            controller: 'adminArchiveController'\n          })\n          .state('admin.order-details', {\n            url:'/order-details/:id',\n            templateUrl: './app/components/admin/order-details/order-details.html',\n            controller: 'orderDetailsController'\n          })\n      .state('thanks', {\n        url: '/thanks',\n        templateUrl: './app/components/thanks/thanks.html'\n      })\n    // .state('place-order', {\n    //   url: '/place-order',\n    //   controller: 'placeOrderController',\n    //   templateUrl: './components/place-order/place-order.html'\n    // })\n    // .state('confirmation', {\n    //   url: '/confirmation',\n    //   controller: 'confirmationController',\n    //   templateUrl: './components/confirmation/confirmation.html'\n    // })\n\n    $urlRouterProvider\n      .otherwise('/home');\n  };\n\n  function scrollFix($rootScope, $window) {\n    $rootScope.$on('$stateChangeSuccess', function () {\n      $window.scrollTo(0, 0);\n    })\n  };\n\n})();\n","(function() {\n\n  angular\n    .module('app')\n    .controller('aboutController', ['$scope', aboutController]);\n\n  function aboutController($scope) {\n\n\n  };\n})();","(function() {\n\n  angular\n    .module('app')\n    .controller('accountController', ['$scope', 'bookService', 'addressService', 'UserService', 'user', accountController]);\n\n  function accountController($scope, BookService, addressService, UserService, user) {\n\n    $scope.user = user;\n    // addressService.user = $scope.user;\n    console.log(user);\n\n    BookService.getUserBooks(user._id).then(function(res){\n      $scope.userBooks = res;\n      console.log($scope.userBooks);\n    })\n\n    addressService.getAddress(user._id).then(function(res){\n      $scope.userAddress = res[0];\n      console.log(res[0], 'addressCtrl');\n    })\n\n    $scope.updateUser = function(update){\n      if(address){\n        update._id = user._id;\n        console.log(update);\n        UserService.updateUser(update);\n      }\n\n    }\n\n\n    $scope.CreateAddress = function(address){\n      if(address !== undefined){\n        address.user = $scope.user._id;\n        addressService.postAddress(address);\n        console.log(address);\n      }\n\n    }\n    var input = document.querySelectorAll('input');\n    for(var x = 0; x < input.length; x++){\n      input[x].setAttribute('size', input[x].getAttribute('placeholder').length);\n    }\n\n\n  };\n\n\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('accountDir', accountDir);\n\n  function accountDir() {\n\n    return {\n      restrict: 'A',\n      link: (scope, elem, attrs) => {\n        // var length = $(elem).attr('placeholder').split('.')[1].split('');\n        // length.splice(-2)\n        // var keyName = length.join('');\n        // $(elem).css('width', scope.user[keyName].length * 8 + 20 + 'px');\n        $('.accountInfoBtn').on('click', function(){\n          $('#accountSavedAlert').addClass('alertSave');\n          setTimeout(function(){\n            $('#accountSavedAlert').removeClass('alertSave');\n          }, 1500)\n        })\n        $('.accountInfoBtn2').on('click', function(){\n          $('#accountSavedAlert2').addClass('alertSave');\n          setTimeout(function(){\n            $('#accountSavedAlert2').removeClass('alertSave');\n          }, 1500)\n        })\n      }\n    }\n  };\n})();\n","(function () {\n  angular\n\n    .module('app')\n    .controller('adminController', ['$scope', 'ProductService',     adminController]);\n\n  function adminController($scope, ProductService) {\n\n  };\n})();\n","(function(){\n   angular\n    .module('app')\n    .controller('bookBuilderController', ['$scope', '$state', '$uibModal', '$timeout', 'user', 'bookService', 'modalService', 'CartService', bookBuilderController]);\n\n      function bookBuilderController($scope, $state, $uibModal, $timeout, user, bookService, modalService, CartService){\n\n        $scope.saved = false;\n        $scope.userBooks;\n        $scope.user = user;\n\n        $scope.getActiveOrder = () => {\n          CartService.getActiveOrder(user._id)\n          .then((res) => { $scope.activeOrder = res })\n        }\n        $scope.getActiveOrder();\n\n        let resetPages = () => {\n          $scope.pages = [];\n        }\n\n        $scope.getUserBooks = () => {\n          bookService.getUserBooks(user._id)\n          .then((res) => { $scope.userBooks = res })\n        }\n\n        $scope.createNewBook = (title, img, user) => {\n          if($scope.userBooks.length === 0 && !title){\n            $scope.openAlertModal();\n          } else {\n            resetPages();\n            $scope.addNewPage();\n            let book = {\n              title: title,\n              title_img: img,\n              user: user,\n              pages: $scope.pages\n            }\n            bookService.createNewBook(book)\n            .then((res) => {\n              $scope.currentBook = res.data;\n              $scope.fillBookInfo($scope.currentBook);\n              $scope.getUserBooks();\n            })\n            .catch((err) => { console.error(\"Book creation failed!\", err) })\n          }\n        }\n\n        $scope.initialLoad = () => {\n          bookService.getUserBooks(user._id)\n          .then((res) => {\n            $scope.userBooks = res;\n            if($scope.userBooks.length > 0){\n              $scope.fillBookInfo($scope.userBooks[$scope.userBooks.length - 1])\n            } else {\n              //Provide HTML for new project\n            }\n          })\n          .catch((err) => { console.error(err) })\n        }\n        $scope.initialLoad();\n\n        $scope.fillBookInfo = (book) => {\n          resetPages();\n          $scope.currentBook = book;\n          for(var i of book.pages){\n            $scope.fillPage(i);\n          }\n        }\n\n        $scope.fillPage = (i) => {\n          $scope.pages.push(\n            {\n              text: i.text,\n              page_type: i.page_type,\n              activity_type: i.activity_type,\n              custom_activity: i.custom_activity,\n              image_url: i.image_url,\n              edit_allowed: i.edit_allowed,\n              page_number: i.page_number\n            }\n          );\n        }\n\n        $scope.addNewPage = () => {\n          $scope.pages.push(\n            {\n              text: \"\",\n              page_type: \"Basic\",\n              activity_type: \"\",\n              custom_activity: \"\",\n              image_url: \"\",\n              edit_allowed: false,\n              page_number: $scope.pages.length + 1\n            }\n          )\n          $scope.saved = false;\n        }\n\n        let updatePageNums = (arr) => {\n          for(var i=0; i<arr.length; i++){\n            arr[i].page_number = i+1;\n          }\n        }\n\n        $scope.removePage = (i) => {\n          if($scope.pages.length > 1){\n            $timeout(() => {\n              $scope.pages.splice(i, 1);\n              updatePageNums($scope.pages);\n            }, 250)\n          }\n          $scope.saved = false;\n        }\n\n        $scope.saveBook = () => {\n          $scope.currentBook.pages = $scope.pages;\n          bookService.saveBook($scope.currentBook)\n          .then((res) => {\n            $scope.saved = true;\n          })\n        }\n        $scope.openViewProjectsModal = () => {\n          let m = modalService.openViewProjectsModal(user, $scope.userBooks)\n          m.result.then((data) => {\n\n            $scope.getUserBooks();\n            if(data.message == \"closed\"){\n              for(var i of data.deleted){\n                if($scope.currentBook._id === i){\n                  $scope.fillBookInfo($scope.userBooks[$scope.userBooks.length -1]);\n                  break;\n                }\n              }\n            } else {\n              $scope.fillBookInfo(data);\n            }\n          })\n        }\n\n        $scope.openNewProjectModal = () => {\n          let m = modalService.openNewProjectModal()\n          m.result.then((data) => {\n            if(data !== \"close\"){\n              $scope.createNewBook(data.title, data.title_img, user._id);\n              $scope.getUserBooks();\n            }\n          })\n        }\n\n        $scope.openReviewModal = () => {\n          let m = modalService.openReviewModal()\n        }\n\n        $scope.openAlertModal = () => {\n          let modalInstance = $uibModal.open({\n            animation: true,\n            size: 'sm',\n            templateUrl: '/app/components/book-builder/project-view-modal/open-alert-modal/alertModal.html',\n            controller: 'alertModalCtrl'\n          })\n        }\n\n        $scope.selectPrints = () => {\n          let m = modalService.openPrintsModal()\n          m.result.then((data) => {\n            if(data !== 'cancel'){\n              $scope.currentBook.print_qty = data;\n              $scope.saveBook();\n              $scope.saveToOrder($scope.currentBook, user);\n            }\n          })\n        }\n\n        $scope.saveToOrder = (book, user) => {\n          if(!$scope.activeOrder._id){\n            CartService.createNewOrder(book._id, user._id)\n            .then((res) => {\n              $state.go('cart');\n            })\n          } else {\n            let bookArray = $scope.activeOrder.books;\n            // Check for duplicates and replace if duplicate\n            for(var i in bookArray){\n              if(book._id == bookArray[i]){\n                bookArray.splice(i, 1);\n              }\n            }\n            bookArray.push(book._id)\n            CartService.addBookToOrder($scope.activeOrder._id, bookArray)\n            .then((res) => {\n              $state.go('cart');\n            })\n            .catch((err) => {\n              console.log(err);\n            })\n          }\n        }\n      }\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('bookbuilderDir', bookbuilderDir);\n\n  function bookbuilderDir() {\n\n      return {\n        restrict: 'A',\n        link: (scope, elem, attrs) => {\n\n          $('.descrowtrigger').on('click', function(){\n            $('.descrow').toggleClass('trigger');\n            if($('#bookbuilderHideSpan').html() === 'Hide'){\n              $('#bookbuilderHideSpan').html('Review');\n            }else{\n              $('#bookbuilderHideSpan').html('Hide');\n            }\n          })\n          $('#bbPencil').on('click', function() {\n            $('.upperInput').addClass('bb-title-input');\n            $('.upperInput').select();\n            $('.upper').addClass('bb-title-disappear');\n            $('#bbPencil').addClass('bb-title-disappear');\n\n          })\n          $(document).keypress(function(e){\n            if(e.which == 13) {\n              $('.upperInput').removeClass('bb-title-input');\n              $('.upper').removeClass('bb-title-disappear');\n              $('#bbPencil').removeClass('bb-title-disappear');\n            }\n          })\n          $('.upperInput').focusout(function(){\n            $('.upperInput').removeClass('bb-title-input');\n            $('.upper').removeClass('bb-title-disappear');\n            $('#bbPencil').removeClass('bb-title-disappear');\n          })\n        }\n      };\n    };\n})();\n","(function () {\n  \n  angular\n    .module('app')\n    .controller('cartController', ['user', '$scope', 'CartService', cartController]);\n\n  function cartController(user, $scope, CartService) {\n\n    $scope.showCart = false;\n    $scope.defaultMessage = \"Loading...\"\n\n    getActiveOrder(user._id);\n\n    $scope.$watch('order', (newVal, oldVal) => {\n      if (newVal !== oldVal) {\n        messageHandler(newVal);\n      }\n    });\n\n    function getActiveOrder(userId) {\n      CartService.getActiveOrder(userId)\n        .then((res) => {\n          let orderId = res._id;\n          CartService.getOrderDetails(orderId)\n            .then((res) => {\n              $scope.order = res;\n              messageHandler(res);\n            })\n            .catch((err) => {\n              messageHandler(err);\n              console.log(err)\n            });\n        })\n        .catch((err) => {\n          messageHandler(err)\n          console.log(err);\n        });\n    };\n\n    function messageHandler(order) {\n      if (!order || !order.cart || order.cart.length < 1) {\n        $scope.defaultMessage = \"Your cart is currently empty\";\n      } else {\n        $scope.showCart = true;\n      }\n    };\n\n  };\n})();\n","(function() {\n\n  angular\n    .module('app')\n    .controller('homeController', ['$scope', homeController]);\n\n  function homeController($scope) {\n\n    $scope.howItWorks = [\n      {\n        imgUrl: '../../../assets/images/HIW1.png',\n        desc: 'Customize your coloring book and tell your family\\'s story. Select the number and type of pages and submit your text.<br /><a class=\"underline-link about-link\" href=\"/#!/start\"><em>Learn more</em></a>'\n      },\n      {\n        imgUrl: '../../../assets/images/HIW2.png',\n        desc: 'We\\'ll draw the perfect pictures to correspond with your text and preferences for each page.<br /><a class=\"underline-link about-link\" href=\"/#!/start\"><em>Learn more</em></a>'\n      },\n      {\n        imgUrl: '../../../assets/images/HIW3.png',\n        desc: 'You\\'ll receive your custom coloring book as a digital file, or choose to have it printed and delivered to your door.<br /><a class=\"underline-link about-link\" href=\"/#!/start\"><em>Learn more</em></a>'\n      }\n    ];\n\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('howItWorks', howItWorks);\n\n  function howItWorks() {\n\n    return {\n      restrict: 'E',\n      scope: {\n        imgUrl: \"=\",\n        desc: \"=\"\n      },\n      template: '<div><img ng-src=\"{{imgUrl}}\"></div><br /><div class=\"divider\"></div><br /><div ng-bind-html=\"desc | renderHTML\"></div>',\n      link: (scope, elem, attrs) => {\n        $(window).scroll(function(){\n          if($(this).scrollTop() > 250){\n            $('#howItWorksSpan').addClass('homeScrollanime');\n          }\n          if($(this).scrollTop() > 500){\n            // $('.howItWorks').fadeIn('4000');\n            $('.how-it-works').addClass('homeScrollanime');\n          }\n          if($(this).scrollTop() > 700){\n            // $('.howItWorks').fadeIn('4000');\n            $('.homeBottomCon').addClass('homeScrollanime');\n          }\n        })\n      }\n    }\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('parallax', parallax);\n  \n  function parallax() {\n\n      return {\n        restrict: 'C',\n        link: (scope, elem, attrs) => {\n\n          $(window).scroll(() => {\n            let winScroll = $(window).scrollTop();\n            $(elem)\n              .css('transform', `translateY(-${winScroll / 6}%)`);\n\n          })\n        }\n      };\n    };\n})();\n\n","(function() {\n\n  angular\n    .module('app')\n    .controller('printsController', ['$scope', '$uibModal', printsController]);\n\n  function printsController($scope, $uibModal, $log, $document) {\n\n    \n    $scope.test = 'test';\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .controller('startController', ['$scope', '$state', 'ProductService', 'AuthService', 'user', startController]);\n\n  function startController($scope, $state, ProductService, AuthService, user) {\n\n    getProductByCategory('page');\n\n    $scope.user = user;\n    $scope.login = (stateOption) => {\n      AuthService.login(stateOption);\n    };\n    $scope.goToState = (state) => {\n      $state.go(state)\n    };\n\n    function getProductByCategory(category) {\n      ProductService.getProductByCategory(category)\n        .then((response) => { $scope.pageTypes = response })\n        .catch((error) => console.log(error))\n    };\n\n  };\n})();","(function () {\n  angular\n    .module('app')\n    .directive('bgImg', bgImg);\n\n  function bgImg() {\n    return {\n      link: (scope, elem, attr) => {\n         var url = attr.bgImg;\n         elem.css({\n            'background-image': `url(${url})`,\n            'background-size': 'cover'\n         })\n      }\n    }\n  };\n})();","(function(){\n   angular\n    .module('app')\n    .controller('alertModalCtrl', ['$scope', '$uibModalInstance', alertModalCtrl]);\n\n    function alertModalCtrl($scope, $uibModalInstance){\n      $scope.cancel = () => {\n        $uibModalInstance.close('cancel')\n      }\n      $scope.confirm = () => {\n        $uibModalInstance.close('confirm');\n      };\n    }\n})();","(function() {\n\n  angular\n    .module('app')\n    .service('addressService', addressService);\n\n  function addressService($http) {\n    this.getAddress = function(user) {\n      return $http.get('/api/address?user=' + user).then(function(res){\n        return res.data;\n      })\n    };\n\n\n    this.postAddress = function(address) {\n      return $http({\n        method: \"POST\",\n        url: \"/api/address\",\n        data: address\n      })\n    }\n\n\n\n\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .service('AdminService', ['$http', AdminService]);\n\n  function AdminService($http) {\n\n    this.getAllActiveOrders = () => {\n      return $http({\n        method: 'GET',\n        url: `/api/allactiveorders`\n      })\n        .then((res) => {\n          if (res === 'No active orders') {\n            console.log(res);\n          } else {\n            return res.data;\n          }\n        })\n        .catch((err) => {\n          throw err;\n        });\n    };\n\n    this.getAllArchivedOrders = () => {\n      return $http({\n        method: 'GET',\n        url: `/api/allarchivedorders`\n      })\n        .then((res) => {\n          return res.data;\n        })\n        .catch((err) => {\n          console.log(err);\n          throw err;\n        })\n    };\n\n    this.getOneOrderById = (orderId) => {\n      return $http({\n        method: 'GET',\n        url: `/api/order/${orderId}`\n      })\n        .then((res) => {\n          return res.data;\n        })\n        .catch((err) => {\n          console.log(err);\n          throw err;\n        });\n    };\n\n    this.updateOrder = (orderId, update) => {\n\n      return $http({\n        method: 'PUT',\n        url: `/api/order/${orderId}`,\n        data: update\n      })\n      .then((res) => {\n        return res.data;\n      })\n      .catch((err) => {\n        console.log(err);\n        throw err;\n      });\n    };\n\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .service('AuthService', ['$http', '$rootScope', '$state', '$location', '$window', AuthService]);\n\n  function AuthService($http, $rootScope, $state, $location, $window) {\n\n    this.logout = () => {\n      return $http({\n        method: 'GET',\n        url: '/api/logout'\n      })\n        .then((res) => {\n          $rootScope.$emit('user', null);\n          $state.go('home');\n          return res;\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n    }\n\n    this.checkUser = () => {\n      return $http({\n        method: 'GET',\n        url: '/api/auth/me'\n      })\n        .then((res) => {\n          console.log('authservice checkuser', res.data)\n          $rootScope.$emit('user', res.data)\n          return res.data;\n        })\n        .catch((err) => {\n          $rootScope.$emit('user', null)\n          throw err;\n        })\n    };\n\n    this.login = (stateOption) => {\n      let state = $state.current.name;\n      if (stateOption) {\n        state = stateOption;\n      };\n      location.href = `/api/auth?state=${state}`;\n    };\n\n  };\n})();\n\n\n","(function() {\n\n  angular\n    .module('app')\n    .service('bookService', bookService);\n\n  function bookService($http) {\n\n    this.getUserBooks = (user) => {\n      return $http.get('/api/book?user=' + user)\n      .then((res) => {return res.data})\n      .catch((err) => {console.error(err)})\n    }\n\n    this.createNewBook = (book) => {\n      return $http.post('/api/book', book)\n      .then((res) => {return res})\n      .catch((err) => {console.error(err)})\n    }\n\n    this.saveBook = (book) => {\n      return $http.put(`/api/book/${book._id}`, book)\n      .then((res) => {return res})\n      .catch((err) => {console.error(err)})\n    }\n\n    this.deleteBook = (book) => {\n      return $http.delete(`/api/book/${book._id}`)\n      .then((res) => {return res.data})\n      .catch((err) => {console.error(err)})\n    }\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .service('CartService', ['$http', 'CleanseCartService', CartService]);\n\n  function CartService($http, CleanseCartService) {\n\n    this.createNewOrder = (bookId, userId) => {\n      let order = {\n        books: [bookId],\n        user: userId\n      }\n      return $http.post('/api/order', order)\n      .then((res) => {\n        return res.data;\n      })\n      .catch((err) => {\n        console.log(\"Error creating order: \", err);\n      })\n    }\n\n    this.addBookToOrder = (orderId, bookArr) => {\n      return $http.put(`/api/order/${orderId}`, {'books': bookArr})\n      .then((res) => {\n        return res.data;\n      })\n      .catch((err) => {\n        console.log(\"Error adding book to order: \", err);\n      })\n    }\n\n    this.getActiveOrder = (userId) => {\n      return $http({\n        method: 'GET',\n        url: `/api/activeorder/${userId}`\n      })\n      .then((res) => {\n        if(res === 'No active orders'){\n          console.log(res);\n        } else {\n          return res.data[0];\n        }\n      })\n      .catch((err) => {\n        throw err;\n      })\n    }\n\n    this.getOrderDetails = (orderId) => {\n      return $http({\n        method: 'GET',\n        url: `/api/order/${orderId}`\n      })\n        .then((res) => {\n          return CleanseCartService.cleanseOrder(res.data);\n        })\n        .catch((err) => {\n          throw err;\n        });\n    };\n\n    this.updateCart = (updatedOrder) => {\n      let orderId = updatedOrder._id;\n      let newOrderData = {\n        books: updatedOrder.cart.map((book) => {\n          return book._id\n        })\n      };\n      return $http({\n        method: 'PUT',\n        url: `/api/order/${orderId}`,\n        data: newOrderData\n      })\n        .then((res) => {\n          return CleanseCartService.cleanseOrder(res.data);\n        })\n        .catch((err) => {\n          throw err;\n        })\n    };\n\n    // this.markOrderComplete = function(param) {\n    //\n    // }\n\n    this.putShipAddress = function(orderId, shipping) {\n      return $http({\n        method: 'PUT',\n        url: '/api/order/' + orderId,\n        data: {ship_address: shipping}\n      })\n    }\n\n  };\n})();\n","\n(function () {\n\n  angular\n    .module('app')\n    .service('CleanseCartService', ['ProductService', '$q', CleanseCartService]);\n\n  function CleanseCartService(ProductService, $q) {\n\n    this.cleanseOrder = (resData) => {\n      let order = {\n        _id: resData._id,\n        cart: []\n      };\n\n      let deferred = $q.defer();\n\n      function asyncLoop(i) {\n        if (i >= resData.books.length) return asyncFin();\n\n        let book = resData.books[i];\n        let bookItem = {};\n        let pageProducts = [\n          {\n            page_type: 'Basic',\n            subtotal: 0\n          },\n          {\n            page_type: 'Activity',\n            subtotal: 0\n          },\n          {\n            page_type: 'Portrait',\n            subtotal: 0\n          },\n        ];\n\n        bookItem._id = book._id;\n        bookItem.title = book.title;\n        bookItem.print_qty = book.print_qty;\n        bookItem.pageProducts = pageProducts.filter((product) => {\n          product.quantity = countPageType(book, product.page_type);\n          return product.quantity !== 0;\n        });\n\n        getSubtotals()\n          .then((response) => {\n            response.forEach((elem) => {\n              if (elem.name == 'Basic') {\n                pageProducts[0].subtotal += elem.price * pageProducts[0].quantity;\n              } else if (elem.name == 'Activity') {\n                pageProducts[1].subtotal += elem.price * pageProducts[1].quantity;\n              } else if (elem.name == 'Portrait') {\n                pageProducts[2].subtotal += elem.price * pageProducts[2].quantity;\n              }\n            });\n            order.cart.push(bookItem);\n            asyncLoop(i + 1);\n          })\n      };\n\n      function asyncFin() {\n        deferred.resolve(order);\n      };\n\n      asyncLoop(0);\n\n      return deferred.promise;\n    };\n\n    function countPageType(book, page_type) {\n      let count = 0;\n      book.pages.forEach((elem) => {\n        if (elem.page_type == page_type) count++;\n      })\n      return count;\n    };\n\n    function getSubtotals() {\n      return ProductService.getProductByCategory(\"page\")\n        .then((response) => {\n          return response;\n        })\n        .catch((error) => {\n          throw error;\n        })\n    };\n\n  };\n})();\n","(function(){\n\n  angular.module('app')\n  .service('modalService', ['$uibModal', modalService])\n\n    function modalService($uibModal){\n\n      this.openViewProjectsModal = (user, userBooks) => {\n        return $uibModal.open({\n          animation: true,\n          templateUrl: '/app/shared/modals/view-projects-modal/viewProjectsModal.html',\n          controller: 'viewProjectModalCtrl',\n          resolve: {\n            user: function() { return user },\n            userBooks: function() { return userBooks }\n          }\n        })\n      }\n\n      this.openDeleteBookModal = (userBooks, index) => {\n        return $uibModal.open({\n          animation: true,\n          size: 'sm',\n          templateUrl: '/app/shared/modals/delete-book-modal/deleteBookModal.html',\n          controller: 'deleteBookModalCtrl',\n          resolve:{\n            userBooks: function(){ return userBooks },\n            index: function(){ return index }\n          }\n        })\n      }\n\n      this.openNewProjectModal = (user) => {\n        return $uibModal.open({\n          animation: true,\n          templateUrl: '/app/shared/modals/new-project-modal/newProjectModal.html',\n          controller: 'newProjectModalCtrl'\n        })\n      }\n\n      this.openReviewModal =() => {\n        return $uibModal.open({\n          animation: true,\n          templateUrl: '/app/shared/modals/review-modal/reviewModal.html',\n          controller: 'reviewModalCtrl'\n        })\n      }\n\n      this.openAlertModal = (modalController, alertTitle, alertBody, cancelBtnCol, cancelBtnTxt, confirmBtnCol, confirmBtnTxt) => {\n        return $uibModal.open({\n          animation: true,\n          size: 'sm',\n          template: `<div class=\"modal-header\">\n                          <h3>${alertTitle}</h3>\n                        </div>\n                        <div class=\"modal-body\">\n                          <p>${alertBody}</p>\n                        </div>\n                        <div class=\"modal-footer\">\n                          <button class=\"btn btn-${cancelBtnCol}\" ng-click=\"cancel()\">${cancelBtnTxt}</button>\n                          <button class=\"btn btn-${confirmBtnCol}\" ng-click=\"confirm()\">${confirmBtnTxt}</button>\n                        </div>`,\n          controller: `${modalController}`\n        })\n      }\n\n      this.openPrintsModal = (user) => {\n          return $uibModal.open({\n            animation: true,\n            size: \"lg\",\n            templateUrl: '/app/shared/modals/prints-modal/printsModal.html',\n            controller: 'printsModalCtrl',\n            resolve:{\n              user: function() { return user },\n            }\n          })\n      }\n\n    }\n})()","(function () {\n\n  angular\n    .module('app')\n    .service('ProductService', ['$http', ProductService]);\n\n  function ProductService($http) {\n\n    this.getProductByName = (name) => {\n      return $http({\n        method: 'GET',\n        url: `/api/product?name=${name}`\n      })\n        .then((response) => {\n          return response.data[0];\n        })\n        .catch((error) => {\n          console.log(error);\n          throw error;\n        })\n    };\n\n    this.getProductByCategory = (category) => {\n      return $http({\n        method: 'GET',\n        url: `/api/product?category=${category}`\n      })\n        .then((response) => {\n          return response.data;\n        })\n        .catch((error) => {\n          console.log(error);\n          throw error;\n        })\n    };\n\n    this.getAllProducts = () => {\n      return $http({\n        method: 'GET',\n        url: `/api/product`\n      })\n        .then((response) => {\n          return response.data\n        })\n        .catch((error) => {\n          console.log(error);\n          throw error;\n        })\n    };\n\n    this.updateProduct = (product) => {\n      let _id = product._id\n      return $http({\n        method: 'PUT',\n        url: `/api/product/${_id}`,\n        data: JSON.stringify(product)\n      })\n        .then((response) => {\n          return response.data\n        })\n        .catch((error) => {\n          throw error;\n        });\n\n    };\n\n  };\n})();\n","(function() {\n\n  angular\n    .module('app')\n    .filter('renderHTML', ['$sce', renderHTML]);\n\n  function renderHTML($sce) {\n      return function(string) {\n        return $sce.trustAsHtml(string)\n      }\n    };\n\n})();","(function () {\n\n  angular\n    .module('app')\n    .service('S3Service', ['$http', '$q', S3Service])\n\n  function S3Service($http, $q) {\n\n    this.uploadPhoto = function (photo) {\n    \n      photo = angular.toJson(photo);\n\n      return $http.post('/api/upload-photos', photo)\n        .then((res) => {\n          return res.data;\n        })\n        .catch((err) => {\n          console.log(err);\n          return err;\n        });\n    };\n\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .service('StripeService', ['$http', 'stripe', StripeService]);\n\n   function StripeService($http, stripe) {\n  //\n  //   this.makePayment = function(card, payment) {\n  //     return stripe.card.createToken(card)\n  //     .then(function (response) {\n  //       console.log('token created for card ending in ', response.card.last4);\n  //       var payment = angular.copy(payment);\n  //       payment.card = void 0;\n  //       payment.token = response.id;\n  //\n  //       return $http({\n  //         method: 'POST',\n  //         url: '/api/payment',\n  //         data: {\n  //           amount: $scope.cartTotal * 100,\n  //           payment: payment\n  //         }\n  //       })\n  //     })\n  //   }\n\n\n};\n})();\n\n// angular.module('app')\n//     .service('StripeService', function($http) {\n//         this.chargeCard = function(source, amount, email) {\n//                 let obj = {\n//                     stripeSource: source,\n//                     amount: amount,\n//                     email: email\n//                 }\n//                 return $http.post('/rent-charge-card', obj);\n//             }\n//     });\n","(function() {\n\n  angular\n    .module('app')\n    .service('UserService', ['$http', UserService]);\n\n  function UserService($http) {\n    this.getUser = function() {\n      return $http.get('/api/auth/me').then(function(res){\n        console.log(res.data);\n        return res.data;\n      })\n    };\n    this.updateUser = function(user){\n      return $http({\n        method: 'PUT',\n        url: '/api/user/' + user._id,\n        data: user\n      })\n    }\n\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .controller('adminArchiveController', ['$scope', 'AdminService', adminArchiveController]);\n\n  function adminArchiveController($scope, AdminService) {\n\n    getAllArchivedOrders();\n\n    function getAllArchivedOrders() {\n      AdminService.getAllArchivedOrders()\n        .then((res) => {\n          if (!Array.isArray(res)) {\n            console.log(res);\n            $scope.allOrders = [];\n            return;\n          } else {\n          $scope.allOrders = res;\n          };\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    };\n\n  };\n})();","(function () {\n\n  angular\n    .module(\"app\")\n    .controller(\"orderDetailsController\", [\"$scope\", \"$stateParams\", \"AdminService\", orderDetailsController]);\n\n  function orderDetailsController($scope, $stateParams, AdminService) {\n    \n    getOneOrderById($stateParams.id);\n    $scope.abbreviatedId = abbreviateId($stateParams.id)\n\n    function getOneOrderById(orderId) {\n      AdminService.getOneOrderById(orderId)\n        .then((res) => {\n          $scope.order = res;\n          console.log($scope.order)\n        }) \n        .catch((err) => {\n          console.log(err);\n        });\n    };\n\n    function abbreviateId(orderId) {\n      return orderId.slice(0, 6)\n    };\n\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .controller('adminOrdersController', [\"$scope\", \"AdminService\", adminOrdersController]);\n\n  function adminOrdersController($scope, AdminService) {\n\n    getAllActiveOrders();\n\n    function getAllActiveOrders() {\n      AdminService.getAllActiveOrders()\n        .then((res) => {\n          if (!Array.isArray(res)) {\n            console.log(res);\n            $scope.allOrders = [];\n            return;\n          } else {\n            console.log(res)\n            $scope.allOrders = res;\n          };\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    };\n\n  };\n})();","(function() {\n  angular\n    .module('app')\n    .directive('ordersTable', ordersTable);\n\n  function ordersTable() {\n\n    return {\n      restrict: 'A',\n      scope: {\n        allOrders: '=',\n        toggleSwitch: '@',\n        filterPredicate: '=',\n        orderPredicate: '='\n      },\n      templateUrl: './app/components/admin/orders-table/orders-table.html',\n      controller: 'ordersTableController',\n      bindToController: true,\n      controllerAs: 'ctrl',\n      link: link\n    };\n\n    function link(scope, elem, attrs, ctrl) {\n      \n      \n    };\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .controller('ordersTableController', ['$scope', 'AdminService', ordersTableController]);\n\n  function ordersTableController($scope, AdminService) {\n\n    let ctrl = this;\n\n    $scope.$watch('ctrl.allOrders', (newValue) => {\n      if (newValue) {\n        ctrl.allOrders = newValue;\n      }\n    });\n\n    ctrl.countTotalPages = (order) => {\n      let total = 0;\n      if (order && order.books && order.books.length > 0) {\n        order.books.forEach((book) => {\n          if (book.pages && book.pages.length > 0) {\n            book.pages.forEach((page) => {\n              total++;\n            });\n          };\n        });\n      };\n      return total;\n    };\n\n    ctrl.toggleArchived = (order, toggle) => {\n      let orderId = order._id;\n      let data = {};\n      if (toggle === \"archive\") {\n        data.archived = true;\n        archiveOrder(orderId, data);\n      } else if (toggle === \"unarchive\") {\n        data.archived = false;\n        unarchiveOrder(orderId, data);\n      };\n    };\n\n    function archiveOrder(orderId, data) {\n      AdminService.updateOrder(orderId, data)\n        .then((res) => {\n          AdminService.getAllActiveOrders()\n            .then((res) => {\n              if (!Array.isArray(res)) {\n                console.log(res);\n                ctrl.allOrders = [];\n                return;\n              } else {\n                ctrl.allOrders = res;\n              };\n            })\n            .catch((err) => {\n              console.log(err);\n              throw err;\n            })\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n    }\n\n    function unarchiveOrder(orderId, data) {\n      AdminService.updateOrder(orderId, data)\n        .then((res) => {\n          AdminService.getAllArchivedOrders()\n            .then((res) => {\n              if (!Array.isArray(res)) {\n                console.log(res);\n                ctrl.allOrders = [];\n                return;\n              } else {\n                ctrl.allOrders = res;\n              };\n            })\n            .catch((err) => {\n              console.log(err);\n              throw err;\n            })\n        })\n        .catch((err) => {\n          console.log(err);\n        })\n    }\n\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .controller('adminPageProductsController', [\"$scope\", \"ProductService\", adminPageProductsController]);\n\n  function adminPageProductsController($scope, ProductService) {\n\n    getAllProducts();\n\n    function getAllProducts() {\n      ProductService.getProductByCategory('page')\n        .then((response) => {\n          $scope.allProducts = response;\n        })\n        .catch((error) => {\n          console.log(error)\n        });\n    };\n\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .controller('adminPrintProductsController', [\"$scope\", \"ProductService\", adminPrintProductsController]);\n\n  function adminPrintProductsController($scope, ProductService) {\n\n    getAllProducts();\n\n    function getAllProducts() {\n      ProductService.getProductByCategory('prints')\n        .then((response) => {\n          $scope.allProducts = response;\n        })\n        .catch((error) => {\n          console.log(error)\n        });\n    };\n\n  };\n})();","(function() {\n  angular\n    .module('app')\n    .directive('productTable', productTable);\n\n  function productTable() {\n\n    return {\n      restrict: 'A',\n      scope: {\n        allProducts: '=',\n        productType: '@'\n      },\n      templateUrl: './app/components/admin/product-table/product-table.html',\n      controller: 'productTableController',\n      bindToController: true,\n      controllerAs: 'ctrl',\n      link: link\n    };\n\n    function link(scope, elem, attrs, ctrl) {\n\n    };\n\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .controller('productTableController', ['ProductService', '$scope', productTableController]);\n\n  function productTableController(ProductService, $scope) {\n\n    let ctrl = this;\n\n    $scope.$watch('ctrl.allProducts', (newValue) => {\n      if (newValue) ctrl.allProducts = newValue;\n    });\n\n    ctrl.submitProductChanges = (product) => {\n        ProductService.updateProduct(product)\n          .then((res) => {\n            ProductService.getProductByCategory(ctrl.productType)\n              .then(res => {\n                ctrl.allProducts = res;\n              })\n              .catch((err) => {\n                throw err;\n              })\n          })\n          .catch((err) => {\n            console.log(err);\n          })\n      };\n    };\n})();","(function(){\n   angular\n    .module('app')\n    .controller('projectModalController', ['$scope', '$http', 'user', 'userBooks', 'bookService', '$uibModal', '$uibModalInstance', projectModalController]);\n\n    function projectModalController($scope, $http, user, userBooks, bookService, $uibModal, $uibModalInstance){\n\n      $scope.userBooks = userBooks;\n      $scope.checkBookLength = false;\n      if($scope.userBooks.length < 3){\n        $scope.checkBookLength = true;\n      }\n      if($scope.userBooks.length >= 3){\n        $scope.checkBookLength = false;\n      }\n\n      $scope.openBook = (book) => {\n        $uibModalInstance.close(book);\n      }\n\n      $scope.openDeleteBookModal = (index) => {\n          let modalInstance = $uibModal.open({\n            animation: true,\n            size: 'sm',\n            templateUrl: '/app/components/book-builder/project-view-modal/delete-book-modal/deleteBookModal.html',\n            controller: 'deleteBookModalController',\n            resolve:{\n              userBooks: function(){ return $scope.userBooks },\n              index: function(){ return index }\n            }\n          })\n          modalInstance.result.then((res) => {\n            $scope.deletedIndex = index;\n            if(res === 'delete'){\n              $scope.deleteBook(userBooks[index]);\n              $scope.userBooks.splice(index, 1);\n              if($scope.userBooks.length < 3){\n                $scope.checkBookLength = true;\n              }\n              if($scope.userBooks.length >= 3){\n                $scope.checkBookLength = false;\n              }\n            }\n          })\n      }\n\n      $scope.openAlertModal = () => {\n        let modalInstance = $uibModal.open({\n          animation: true,\n          size: 'sm',\n          templateUrl: '/app/components/book-builder/project-view-modal/open-alert-modal/alertModal.html',\n          controller: 'alertModalCtrl'\n        })\n      }\n\n      $scope.deleteBook = (book) => {\n        bookService.deleteBook(book)\n        .then((res) => {\n          console.log(res)\n        })\n        .catch((err) => {console.error(err)})\n      }\n\n      $scope.createNewBook = () => {\n        if(!$scope.newBookTitle){\n          $scope.openAlertModal();\n        } else {\n          let book = {\n            title: $scope.newBookTitle,\n            title_img: $scope.titleImg,\n            user: user._id,\n          }\n          $uibModalInstance.close(book);\n        }\n      }\n\n      $scope.close = function(){\n        $uibModalInstance.close('close');\n      };\n    }\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('cart', cart);\n\n  function cart() {\n\n    return {\n      restrict: 'E',\n      scope: {\n        order: '=',\n        cartTotal: '='\n      },\n      templateUrl: './app/components/cart/cart-directive/cart-directive.html',\n      controller: 'cartDirectiveController',\n      bindToController: true,\n      controllerAs: 'ctrl',\n      link: link\n    };\n\n    function link(scope, elem, attrs, ctrl) {\n\n      ctrl.removeItem = (bookId) => {        \n        $(`.cart-item-${bookId}`).slideUp(150, () => {\n          ctrl.deleteBook(bookId)\n        });\n      };\n\n    };\n\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .controller('cartDirectiveController', ['$scope', '$uibModal', 'CartService', '$rootScope', cartDirectiveController]);\n\n  function cartDirectiveController($scope, $uibModal, CartService, $rootScope) {\n\n    let ctrl = this;\n\n    $scope.$watch('ctrl.order', (newVal) => {\n      \"fired\"\n      if (newVal) ctrl.cartTotal = getCartTotal(newVal[\"cart\"]);\n    });\n    // UNNECESSARY?\n\n    ctrl.deleteBook = (bookId) => {\n      ctrl.order.cart = ctrl.order.cart.filter((elem) => {\n        return elem._id !== bookId;\n      });\n      ctrl.cartTotal = getCartTotal(ctrl.order.cart);\n      \n      CartService.updateCart(ctrl.order)\n        .then((res) => {\n          ctrl.order = res;\n          $rootScope.$emit('updateOrder');\n        })\n        .catch((err) => {\n          ctrl.order = {};\n          console.log(err);\n        })\n    };\n\n    function getCartTotal(cart) {\n      let total = 0;\n      cart.forEach((book) => {\n        if (book.print_qty) {\n          console.log(typeof(book.print_qty.price), book.print_qty.price)\n          total += book.print_qty.price;\n        }\n        book.pageProducts.forEach((pageProduct) => {\n          total += pageProduct.subtotal;\n        });\n      });\n      console.log(\"cart-total\", total)\n      return total;\n    };\n\n  ctrl.openPaymentModal = () => {\n    console.log(\"Cart Directive says: \", ctrl.order);\n    let modalInstance = $uibModal.open({\n      animation: true,\n      size: 'lg',\n      templateUrl: 'app/components/cart/payment-modal/payment-modal.html',\n      controller: 'paymentModalController',\n      resolve: {\n        cartTotal: function() {\n          return ctrl.cartTotal;\n        },\n        orderId: function() {\n          return ctrl.order._id;\n        }\n      }\n    });\n      modalInstance.result.then((param) => {\n        if (param == 'success') {\n          console.log(\"From cartDirectiveController: Successful payment\");\n        }\n        if (param == 'cancel') {\n          console.log(\"Cancelled\");\n        }\n      });\n    };\n\n  };\n\n})();\n","(function () {\n  angular\n    .module('app')\n    .controller('paymentModalController', ['$scope', 'stripe', '$http', '$state', '$uibModalInstance', 'cartTotal', 'orderId', 'CartService', 'StripeService', paymentModalController]);\n\n  function paymentModalController($scope, stripe, $http, $state, $uibModalInstance, cartTotal, orderId, CartService, StripeService) {\n\n    $scope.cartTotal = cartTotal;\n\n    const unique_order_id = orderId;\n\n    $scope.putShipAddress = function (orderId) {\n      CartService.putShipAddress(unique_order_id, $scope.ship_info)\n    }\n\n    $scope.charge = function (orderId) {\n      return stripe.card.createToken($scope.payment.card)\n        .then(function (response) {\n          console.log('token created for card ending in ', response.card.last4);\n          var payment = angular.copy($scope.payment);\n          payment.card = void 0;\n          payment.token = response.id;\n          console.log(unique_order_id);\n\n          return $http({\n            method: 'POST',\n            url: '/api/payment',\n            data: {\n              amount: $scope.cartTotal * 100,\n              payment: payment,\n              orderId: unique_order_id\n            }\n          })\n        })\n        .then(function (payment) {\n          console.log('successfully submitted payment for $', payment);\n          $uibModalInstance.close('cancel');\n          $state.go('thanks');\n        })\n        .catch(function (err) {\n          if (err.type && /^Stripe/.test(err.type)) {\n            console.log('Stripe error: ', err.message);\n            alert(err.message)\n          } else {\n            console.log('Other error occurred, possibly with your API', err.message);\n            alert(err.message)\n          }\n        });\n    };\n\n    $scope.cancel = function () {\n      $uibModalInstance.close('cancel');\n    }\n\n    $scope.validateNumber = function (value) {\n      if (value) {\n        if ($scope.payment.card.number.validateCardNumber(value)) {\n          $scope.numberError = false;\n          $scope.cardInfoForm.number.$setValidity(\"number\", true);\n          $scope.cardType = Stripe.card.cardType(value);\n        } else {\n          $scope.numberError = true;\n          $scope.cardInfoForm.number.$setValidity(\"number\", false);\n        }\n      }\n    }\n    $scope.validateExpiry = function (month, year) {\n      if (month && year) {\n        let exp = month + ' ' + year;\n        if (Stripe.card.validateExpiry(exp)) {\n          $scope.expiryError = false;\n          $scope.cardInfoForm.month.$setValidity(\"month\", true);\n        } else {\n          $scope.expiryError = true;\n          $scope.cardInfoForm.month.$setValidity(\"month\", false);\n        }\n      }\n    }\n    $scope.validateCVC = function (value) {\n      if (value) {\n        if (Stripe.card.validateCVC(value)) {\n          $scope.cvcError = false;\n          $scope.cardInfoForm.cvc.$setValidity(\"cvc\", true);\n        } else {\n          $scope.cvcError = true;\n          $scope.cardInfoForm.cvc.$setValidity(\"cvc\", false);\n        }\n      }\n    }\n  }\n\n})();\n","(function () {\n  angular\n    .module('app')\n    .directive('animateFade', [animateFade]);\n\n  function animateFade(){\n    return {\n      restrict: 'A',\n      scope: {\n        condition: '=',\n        text: '&'\n      },\n      link: function(scope, elem, attrs){\n        // $(elem).on('click', function(){\n        //   if(scope.condition === false){\n        //     $(elem).switchClass(\"btn-yellow\", \"btn-green\", 300, 'linear')\n        //     scope.condition = true\n        //   } else {\n        //     $(elem).switchClass(\"btn-green\", \"btn-yellow\", 300, 'linear')\n        //     scope.condition = false\n        //   }\n        // })\n      }\n    }\n  }\n})()\n","(function () {\n\n  angular\n    .module('app')\n    .directive('bbImgSliderDir', bbImgSliderDir);\n\n  function bbImgSliderDir() {\n\n      return {\n        restrict: 'A',\n        link: (scope, elem, attrs) => {\n          var transX = 0;\n          var transXM = 0;\n          var transTotal = scope.userBooks.length;\n          var checker = 0;\n          var checkerM = 0;\n          var lengthSaver = scope.userBooks.length;\n          // scope.$watch('userBooks.length', function(newValue, oldValue){\n          //   else if(scope.deletedIndex > 1){\n          //\n          //     if(scope.userBooks.length < lengthSaver){\n          //       console.log(transXM);\n          //       transXM += 185;\n          //       checkerM --;\n          //       transTotal -= 1;\n          //       console.log(transXM);\n          //       $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n          //     }\n          //   }\n          //   else if(scope.deletedIndex === 1){\n          //     console.log('why');\n          //     transXM = 0;\n          //     checkerM = 0;\n          //     transTotal -= 1;\n          //     $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n          //   }\n          //     lengthSaver = scope.userBooks.length;\n          // })\n\n          scope.$watch('userBooks.length', function(newValue, oldValue){\n            if(scope.deletedIndex > 2 && $('.imgSliderAbs').is(\":visible\")){\n              console.log(scope.deletedIndex, 'deletedIndex');\n              if(scope.userBooks.length < lengthSaver){\n                transX += 150;\n                checker --;\n                transTotal -= 1;\n                $('.imgSliderAbs').css(\"transform\", \"translateX(\" + transX + \"px)\");\n                console.log(transTotal, 'transTotal');\n              }\n            }\n             if(scope.deletedIndex <= 2 && $('.imgSliderAbs').is(\":visible\")){\n              transX = 0;\n              checker = 0;\n              transTotal -= 1;\n              $('.imgSliderAbs').css(\"transform\", \"translateX(\" + transX + \"px)\");\n              console.log(scope.deletedIndex, 'deletedIndex');\n            }\n            if(scope.deletedIndex > 1){\n\n              if(scope.userBooks.length < lengthSaver && $('.imgSliderAbs2').is(\":visible\")){\n                console.log(transXM);\n                transXM += 185;\n                checkerM --;\n                transTotal -= 1;\n                console.log(transXM);\n                $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n              }\n            }\n            if(scope.deletedIndex <= 1 && $('.imgSliderAbs2').is(\":visible\")){\n              console.log('why');\n              transXM = 0;\n              checkerM = 0;\n              transTotal -= 1;\n              $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n            }\n              lengthSaver = scope.userBooks.length;\n          })\n// window Resize========================================\n          $(window).resize(function(){\n            if($(window).width() <= 562){\n              transX = 0;\n              checker = 0;\n              $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transX + \"px)\");\n            }\n            if($(window).width() > 562){\n              transX = 0;\n              checker = 0;\n              $('.imgSliderAbs').css(\"transform\", \"translateX(\" + transX + \"px)\");\n            }\n            console.log(scope.deletedIndex);\n          })\n// ====mobile=======================================\n        // scope.$watch('userBooks.length', function(newValue, oldValue){\n        //   if(scope.deletedIndex > 1){\n        //\n        //     if(scope.userBooks.length < lengthSaver){\n        //       console.log(transXM);\n        //       transXM += 185;\n        //       checkerM --;\n        //       transTotal -= 1;\n        //       console.log(transXM);\n        //       $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n        //     }\n        //   }\n        //   else if(scope.deletedIndex === 1){\n        //     console.log('why');\n        //     transXM = 0;\n        //     checkerM = 0;\n        //     transTotal -= 1;\n        //     $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n        //   }\n        //     lengthSaver = scope.userBooks.length;\n        // })\n\n\n      $('#imgSliderTest12').on('click', function(){\n        if(checkerM < transTotal - 1){\n          checkerM ++;\n          transXM -= 185;\n          $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n        }\n      })\n          $('#imgSliderTest22').on('click', function(){\n            if(checkerM > 0){\n              checkerM --;\n              transXM += 185;\n              $('.imgSliderAbs2').css(\"transform\", \"translateX(\" + transXM + \"px)\");\n            }\n          })\n\n// ====mobile====================\n\n          $('#imgSliderTest1').on('click', function(){\n            if(checker < transTotal - 3){\n              checker ++;\n              transX -= 150;\n              $('.imgSliderAbs').css(\"transform\", \"translateX(\" + transX + \"px)\");\n            }\n          })\n          $('#imgSliderTest2').on('click', function(){\n            if(checker > 0){\n              checker --;\n              transX += 150;\n              $('.imgSliderAbs').css(\"transform\", \"translateX(\" + transX + \"px)\");\n            }\n          })\n        }\n      };\n    };\n})();\n// else if(scope.deletedIndex <= 2 && transX === 0){\n//   if($('.imgSliderAbs').hasClass('imgSliderAnime')){\n//     $('.imgSliderAbs').removeClass('imgSliderAnime');\n//   }\n//   transTotal -= 1;\n//   $('.imgSliderAbs').addClass('imgSliderAnime');\n// }\n","(function () {\n  angular\n    .module('app')\n    .directive('footerDirective', [footerDirective]);\n\n  function footerDirective() {\n\n    return {\n      restrict: 'E',\n      templateUrl: './app/shared/directives/footer/footer.html',\n      link: link\n    }\n\n    function link(scope, elem, attr) {\n\n    };\n\n  };\n})();\n","(function() {\n\n  angular\n    .module('app')\n    .controller('modalController', ['$scope', '$uibModalInstance', modalController]);\n\n  function modalController($scope, $uibModalInstance, $log, $document) {\n    $scope.ok = () => {\n        $uibModalInstance.close('ok');\n      }\n  };\n})();\n","(function () {\n  angular\n    .module('app')\n    .directive('alertModalDirective', ['$uibModal' ,modalDirective]);\n\n  function modalDirective($uibModal) {\n    return {\n      restrict: 'EA',\n      template: '<a ng-click=\"open()\">ALERT</a>',\n      scope: {\n        alertTitle: '@',\n        alertBody: '@'\n      },\n      link: function(scope, elem, attrs){\n        scope.open = function(){\n          var modalInstance = $uibModal.open({\n            animation: true,\n            template: `<div class=\"modal-header\">\n                          <h3>${scope.alertTitle}</h3>\n                        </div>\n                        <div class=\"modal-body\">\n                          <p>${scope.alertBody}</p>\n                        </div>\n                        <div class=\"modal-footer\">\n                          <button class=\"btn btn-green\" ng-click=\"ok()\">OK</button>\n                        </div>`,\n            controller: 'modalController',\n            size: 'sm'\n          })\n          modalInstance.result.then( function(res) {\n            console.log(res)\n          })\n        }\n      }\n    }\n  }\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .controller('navController', ['AuthService', 'CartService', '$rootScope', '$state', navController]);\n\n  function navController(AuthService, CartService, $rootScope, $state) {\n\n    let ctrl = this;\n\n    this.login = AuthService.login;\n    this.logout = AuthService.logout;\n\n    $rootScope.$on('user', (event, user) => {\n      ctrl.user = user;\n      checkCartNum();\n    })\n\n    $rootScope.$on('updateOrder', (event) => {\n      checkCartNum();\n    })\n\n    let checkCartNum = () => {\n      if(!ctrl.user){\n        ctrl.cartNum = 0;\n      } else {\n        CartService.getActiveOrder(ctrl.user._id)\n        .then((res) => {\n          ctrl.cartNum = res.books.length;\n        })\n      }\n    }\n  };\n})();","(function () {\n  angular\n    .module('app')\n    .directive('navDirective', navDirective);\n\n  function navDirective() {\n    return {\n      restrict: 'E',\n      scope: true,\n      templateUrl: './app/shared/directives/nav/nav.html',\n      controller: 'navController',\n      bindToController: true,\n      controllerAs: 'ctrl',\n      link: (scope, elem, attr) => {\n\n        $(window).scroll(() => {\n          let winScroll = $(window).scrollTop();\n          if (winScroll > 110) {\n            $(elem)\n              .addClass('sticky-nav');\n\n              $('#navLogo').addClass(\"sticky-nav\")\n              $('#hamDropDownUl').addClass(\"hamDropDownUlWinScroll\");\n          } else {\n            $(elem)\n              .removeClass('sticky-nav');\n\n              $('#navLogo').removeClass(\"sticky-nav\")\n              $('#hamDropDownUl').removeClass(\"hamDropDownUlWinScroll\");\n          }\n        })\n        $('.navBurger').on('click', function(){\n          $(this).toggleClass('ham-anime');\n          $('.hamDropdownContainer').toggleClass('hamDropdownAnime');\n        })\n        $(window).scroll(function(){\n          $('.hamDropdownContainer').removeClass('hamDropdownAnime');\n          $('.navBurger').removeClass('ham-anime');\n        })\n        $(window).resize(function(){\n          $('.hamDropdownContainer').removeClass('hamDropdownAnime');\n          $('.navBurger').removeClass('ham-anime');\n        })\n      }\n    }\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('bookPage', bookPage);\n\n  function bookPage() {\n    return {\n      restrict: 'E',\n      scope: {\n        page: '=',\n        index: '='\n      },\n      templateUrl: './app/shared/directives/page/pageTmpl.html',\n      controller: 'pageDirCtrl',\n      link: (scope, elem, attrs) => {\n\n\n        scope.$watch('wasPageDeleted' ,function(newValue, oldValue){\n          if(newValue){\n            if($('.con' + scope.index).hasClass('pageinitial')){\n              $('.con' + scope.index).removeClass('pageinitial');\n            }\n            $('.con' + scope.index).addClass('page-anime');\n            setTimeout(function(){\n              $('.con' + scope.index).removeClass('page-anime');\n            }, 550);\n          }\n        })\n      }\n    }\n  };\n})();\n","(function(){\n  angular\n    .module('app')\n    .controller('pageDirCtrl', ['$scope', '$uibModal', '$timeout', 'modalService', pageDirCtrl]);\n\n    function pageDirCtrl($scope, $uibModal, $timeout, modalService){\n\n      $scope.page_type = \"Basic\";\n      $scope.activity_type = \"Crossword\";\n      $scope.custom_activity = \"\";\n      $scope.edit_allowed = false;\n      $scope.wasPageDeleted = false;\n\n\n      $scope.pageTypes = [\n        {name: \"Basic\", value: \"Basic\"},\n        {name: \"Activity\", value: \"Activity\"},\n        {name: \"Portrait\", value: \"Portrait\"}\n      ]\n\n      $scope.activity_types = [\n        {name: \"Crossword\", value: \"Crossword\"},\n        {name: \"Connect the Dots\", value: \"Connect the Dots\"},\n        {name: \"Maze\", value: \"Maze\"},\n        {name: \"Custom\", value: \"Custom\"}\n      ]\n\n      $scope.allowTypes = [\n        {name: \"No\", value: false},\n        {name: \"Yes\", value: true}\n      ]\n\n      let modalCtrl = \"alertModalCtrl\",\n          alertTitle = \"Delete this Page?\",\n          alertBody = \"Do you really want to delete this page? This action cannot be undone.\",\n          cancelColor = \"yellow\",\n          cancelText = \"CANCEL\",\n          confirmColor = \"red\",\n          confirmText = \"DELETE\";\n\n      $scope.openAlertModal = () => {\n        let modalInstance = modalService.openAlertModal(modalCtrl, alertTitle, alertBody, cancelColor, cancelText, confirmColor, confirmText);\n\n        modalInstance.result.then((param) => {\n          if(param == 'confirm'){\n            $scope.wasPageDeleted = true;\n            $timeout(function(){\n              $scope.$parent.$parent.removePage($scope.index);\n              $scope.wasPageDeleted = false;\n            }, 200);\n          }\n        })\n      }\n    }\n})();\n","angular.module('app')\n    .directive('cardModalTrigger', function() {\n        return {\n            restrict: 'A',\n            scope: {\n                htmlID: '@cardModalTrigger'\n            },\n            link: function(scope, elem, attrs) {\n                elem.on('click', function(event) {\n                    event.preventDefault();\n                    let id = '#' + scope.htmlID;\n                    $(id).modal('show');\n                });\n            }\n        };\n    });\n","angular.module('app')\n  .directive('creditCardModal', function() {\n    return {\n        restrict: 'E',\n        templateUrl: './js/directives/credit-card-modal/credit-card-modal.html',\n        scope: {\n            model: '=',\n            payRent: '&',\n            chargeAmount: '='\n        },\n        link: function(scope, elem, attrs) {\n\n        }\n    };\n});\n","angular.module('app')\n    .controller('RentPay', function($scope, user, moment, UserService, StripeService) {\n        UserService.getUserById(user._id)\n            .then(function(res) {\n                $scope.user = res;\n\n                if (!$scope.user.rentPaid && todayIsInTimeFrame($scope.user.rentDueDate)) {\n                    $scope.needToPayRent = true;\n                    $scope.lateFees = calculateFees($scope.user.rentDueDate);\n                    $scope.totalRentAmount = $scope.user.rentAmount + $scope.lateFees;\n                } else {\n                    $scope.needToPayRent = false;\n                }\n            }, function(err) {\n                console.log(err);\n            })\n\n        /*********************** PAY RENT ***********************/\n        $scope.payRentBank = function() {\n            Stripe.setPublishableKey('pk_test_GfjALqHyZhwYmd38SfJANoe4');\n            Stripe.bankAccount.createToken({\n                country: 'US',\n                currency: 'USD',\n                routing_number: $scope.accountInfo.routingNumber,\n                account_number: $scope.accountInfo.accountNumber,\n                account_holder_name: $scope.accountInfo.name,\n                account_holder_type: 'individual'\n            }, function(status, response) {\n                if (response.error) {\n                    console.log('ERROR', response.error);\n                } else {\n                    var token = response.id;\n                    StripeService.chargeBank(token, $scope.totalRentAmount, $scope.user.email)\n                        .then(function(res) {\n                            console.log(res);\n                            if (res.status === 200) {\n                                // console.log('Bank Charge went through');\n                                addPaymentToUser();\n                            } else {\n                                console.log('Payment did not go through');\n                            }\n                        }, function(err) {\n                            console.log(err);\n                        })\n                }\n            });\n        };\n\n        /*********************** PAY RENT ***********************/\n        $scope.payRentCard = function() {\n            let rentAmount = $scope.totalRentAmount + (($scope.totalRentAmount * 0.029) + 0.3);\n            Stripe.setPublishableKey('pk_test_GfjALqHyZhwYmd38SfJANoe4');\n            Stripe.source.create({\n                type: 'card',\n                card: {\n                    number: $scope.cardInfo.number,\n                    cvc: $scope.cardInfo.cvc,\n                    exp_month: $scope.cardInfo.month,\n                    exp_year: $scope.cardInfo.year,\n                },\n                owner: {\n                    address: {\n                        postal_code: $scope.cardInfo.zip\n                    }\n                }\n            }, function(status, response) {\n                if (response.error) {\n                    console.log('ERROR', response.error);\n                } else {\n                    var source = response.id;\n                    StripeService.chargeCard(source, rentAmount, $scope.user.email)\n                        .then(function(res) {\n                            console.log(res);\n                            if (res.status === 200) {\n                                // console.log('Card charge went through');\n                                addPaymentToUser();\n                            } else {\n                                console.log('Payment did not go through');\n                            }\n                        }, function(err) {\n                            console.log(err);\n                        })\n                }\n            });\n        };\n\n        /*********************** ADD PAYMENT TO USER ***********************/\n        function addPaymentToUser() {\n            var payment = {\n                amount: $scope.totalRentAmount,\n                date: new Date(),\n                email: $scope.user.email,\n                userid: $scope.user._id\n            }\n\n            $scope.user.rentDueDate = incrementDueDate($scope.user.rentDueDate);\n            $scope.user.rentPaid = true;\n\n            UserService.updateUser($scope.user._id, $scope.user)\n                .then(function(res) {\n                    UserService.payRent($scope.user._id, payment)\n                        .then(function(res) {\n                            $scope.user = res;\n                            $scope.needToPayRent = false;\n                            $state.go('payment-success');\n                        }, function(err) {\n                            console.log(err);\n                        })\n                }, function(err) {\n                    console.log(err);\n                })\n        }\n\n        /*********************** TODAY IS IN TIME FRAME ***********************/\n        function todayIsInTimeFrame(date) {\n            let dueDate = moment(date);\n            // let dueDate = moment().add(7, 'days');\n            let today = moment();\n            let difference = today.diff(dueDate, 'days');\n\n            if (difference > -7) {\n                return true;\n            } else {\n                return false;\n            }\n        }\n        /*********************** CALCULATE FEES ***********************/\n        function calculateFees(date) {\n            let dueDate = moment(date);\n            // let dueDate = moment().subtract(5, 'days');\n            let today = moment();\n            let difference = today.diff(dueDate, 'days');\n\n            if (difference > 0) {\n                return 50 + ((difference - 1) * 10);\n            } else {\n                return 0;\n            }\n        }\n        /*********************** INCREMENT DUE DATE ***********************/\n        function incrementDueDate(date) {\n            let now = new Date(date);\n            if (now.getMonth() == 11) {\n                return new Date(now.getFullYear() + 1, 0, 1);\n            } else {\n                return new Date(now.getFullYear(), now.getMonth() + 1, 1);\n            }\n        }\n    });\n","(function () {\n\n  angular\n    .module('app')\n    .controller('printsDropdownController', ['$scope', 'ProductService', printsDropdownController]);\n\n  function printsDropdownController($scope, ProductService) {\n\n    let ctrl = this;\n\n    ctrl.prints = [\n      'loading options'\n    ];\n\n    ProductService.getProductByCategory(\"prints\")\n      .then((res) => {\n        if (res) ctrl.prints = res\n      })\n\n    ctrl.setSelection = (option) => {\n      ctrl.printsSelection = option;\n    }\n\n  };\n\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('printsDropdown', printsDropdown);\n\n  function printsDropdown() {\n\n    return {\n      restrict: 'E',\n      scope: {\n        printsSelection: '='\n      },\n      templateUrl: './app/shared/directives/prints-dropdown/prints-dropdown.html',\n      controller: 'printsDropdownController',\n      bindToController: true,\n      controllerAs: 'ctrl',\n      link: link\n    };\n\n    function link(scope, elem, attrs, ctrl) {\n\n    }\n\n  };\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .controller('s3Controller', ['S3Service', s3Controller]);\n\n  function s3Controller(S3Service) {\n\n    let ctrl = this;\n\n    ctrl.buttonText = \"Upload Photo\"\n\n    ctrl.submitPhoto = (photo) => {\n      S3Service.uploadPhoto(photo)\n        .then((res) => {\n          ctrl.inputText = ctrl.successText;\n          ctrl.s3Url = res;\n          document.getElementById('photo-upload').blur();\n        })\n        .catch((err) => {\n          console.log(err)\n        })\n    };\n\n    ctrl.resizer = (photo, extension, maxWidth, maxHeight) => {\n\n      let photoToResize = photo\n\n      let img = new Image();\n      let reader = new FileReader();\n      reader.onload = (onLoadEvent) => {\n\n        img.src = onLoadEvent.target.result\n\n        let MAX_WIDTH = maxWidth\n          , MAX_HEIGHT = maxHeight\n          , width = img.width\n          , height = img.height\n\n        if (width > height) {\n          if (width > MAX_WIDTH) {\n            height *= MAX_WIDTH / width;\n            width = MAX_WIDTH;\n          }\n        } else {\n          if (height > MAX_HEIGHT) {\n            width *= MAX_HEIGHT / height;\n            height = MAX_HEIGHT;\n          }\n        }\n\n        let canvas = document.createElement('canvas');\n        canvas.style.visibility = 'hidden';\n        document.body.appendChild(canvas);\n\n        canvas.width = width;\n        canvas.height = height;\n\n        var ctx = canvas.getContext(\"2d\");\n        ctx.drawImage(img, 0, 0, width, height);\n\n        let resizedPhotoBody =\n          canvas.toDataURL(`image/${extension}`);\n\n        let newImage = {\n          imageBody: resizedPhotoBody,\n          imageExtension: extension\n        }\n        ctrl.submitPhoto(newImage)\n      }\n      reader.readAsDataURL(photoToResize)\n    }\n\n  };\n\n})();","(function () {\n\n  angular\n    .module('app')\n    .directive('s3Uploader', s3Uploader);\n\n  function s3Uploader() {\n\n    return {\n      restrict: 'E',\n      scope: {\n        s3Url: \"=\",\n        repeatId: \"=\"\n      },\n      templateUrl: './app/shared/directives/s3-uploader/s3-uploader.html',\n      controller: 's3Controller',\n      bindToController: true,\n      controllerAs: 'ctrl',\n      link: (scope, elem, attrs, ctrl) => {\n\n        let maxWidth = +(attrs.maxWidth)\n          , maxHeight = +(attrs.maxHeight);\n        \n        ctrl.inputText = attrs.defaultText;\n        ctrl.successText = attrs.successText;\n \n        let input = angular.element(elem[0].querySelector('[s3-input]'));\n\n        input.on('change', (onChangeEvent) => {\n          \n          let reader = new FileReader();\n          reader.onload = (onLoadEvent) => {\n\n            let imageData = onLoadEvent.target.result;\n            let imageExtension = imageData.split(';')[0].split('/')\n\n            imageExtension = imageExtension[imageExtension.length - 1];\n\n            ctrl.resizer(onChangeEvent.target.files[0], imageExtension, maxWidth, maxHeight);\n          };\n          reader.readAsDataURL(onChangeEvent.target.files[0]);\n        }\n        );\n      }\n    };\n  };\n\n})();","(function(){\n   angular\n    .module('app')\n    .controller('deleteBookModalCtrl', ['$scope', '$uibModalInstance', 'userBooks', 'index', deleteBookModalCtrl]);\n\n    function deleteBookModalCtrl($scope, $uibModalInstance, userBooks, index){\n      console.log($scope);\n      \n      $scope.preTitle = userBooks[index].title;\n\n      if($scope.preTitle === undefined){\n        $scope.title = \"untitled\";\n      } else {\n        $scope.title = $scope.preTitle;\n      }\n\n      $scope.delete = () => {\n        $uibModalInstance.close('delete');\n      }\n\n      $scope.cancel = () => {\n        $uibModalInstance.close('cancel');\n      }\n\n    }\n})();","(function(){\n   angular\n    .module('app')\n    .controller('newProjectModalCtrl', ['$scope', 'modalService', '$uibModal', '$uibModalInstance', newProjectModalCtrl]);\n\n    function newProjectModalCtrl($scope, modalService, $uibModal, $uibModalInstance){ \n\n      let modalCtrl = \"alertModalCtrl\",\n          alertTitle = \"Missing Project Title\",\n          alertBody = \"Please provide a title before creating your new project.\",\n          cancelColor = \"white\",\n          cancelText = \"\",\n          confirmColor = \"green\",\n          confirmText = \"OK\";\n\n      $scope.createNewBook = () => {\n        if(!$scope.newBookTitle){\n          modalService.openAlertModal(modalCtrl, alertTitle, alertBody, cancelColor, cancelText, confirmColor, confirmText);\n        } else {\n          let book = {\n            title: $scope.newBookTitle,\n            title_img: $scope.titleImg\n          }\n          $uibModalInstance.close(book);\n        }\n      }\n\n      $scope.close = () => {\n        $uibModalInstance.close('close');\n      };\n    }\n})();\n","(function(){\n   angular\n    .module('app')\n    .controller('alertPrintModalCtrl', ['$scope', '$uibModalInstance', alertPrintModalCtrl]);\n\n    function alertPrintModalCtrl($scope, $uibModalInstance){\n      $scope.ok = function(){\n        $uibModalInstance.close('ok');\n      };\n    }\n})();","(function(){\n   angular\n    .module('app')\n    .controller('printsModalCtrl', ['$scope', '$http', 'bookService', 'CartService', '$uibModal', '$uibModalInstance', 'modalService', printsModalCtrl]);\n\n    function printsModalCtrl($scope, $http, bookService, CartService, $uibModal, $uibModalInstance, modalService){\n\n      let modalCtrl = \"alertModalCtrl\",\n          alertTitle = \"Prints Not Specified\",\n          alertBody = \"Please select a print quantity before sending the project to the cart.\",\n          cancelColor = \"white\",\n          cancelText = \"\",\n          confirmColor = \"green\",\n          confirmText = \"OK\";\n\n      $scope.sendToCart = function(){\n        if(!$scope.selectedPrints){\n          modalService.openAlertModal(modalCtrl, alertTitle, alertBody, cancelColor, cancelText, confirmColor, confirmText);\n        } else {\n          $uibModalInstance.close($scope.selectedPrints);\n        }\n      };\n\n      $scope.cancel = function(){\n        $uibModalInstance.close('cancel');\n      }\n    }\n})();","(function(){\n   angular\n    .module('app')\n    .controller('reviewModalCtrl', ['$scope', 'modalService', '$uibModal', '$uibModalInstance', reviewModalCtrl]);\n\n    function reviewModalCtrl($scope, modalService, $uibModal, $uibModalInstance){ \n      $scope.close = () => {\n        $uibModalInstance.close('close');\n      };\n    }\n})();\n","(function(){\n   angular\n    .module('app')\n    .controller('viewProjectModalCtrl', ['$scope', '$http', 'userBooks', 'bookService', 'modalService', '$uibModal', '$uibModalInstance', viewProjectModalCtrl]);\n\n    function viewProjectModalCtrl($scope, $http, userBooks, bookService, modalService, $uibModal, $uibModalInstance){\n\n      $scope.userBooks = userBooks;\n      let deletedBooks = [];\n      $scope.checkBookLength = false;\n      if($scope.userBooks.length < 3){\n        $scope.checkBookLength = true;\n      }\n      if($scope.userBooks.length >= 3){\n        $scope.checkBookLength = false;\n      }\n\n      $scope.openBook = (book) => {\n        $uibModalInstance.close(book);\n      }\n\n      $scope.openDeleteBookModal = (index) => {\n          let m = modalService.openDeleteBookModal($scope.userBooks, index)\n          m.result.then((res) => {\n            if(res === 'delete'){\n              $scope.deleteBook(userBooks[index]);\n              $scope.deletedIndex = index;\n              $scope.userBooks.splice(index, 1);\n              if($scope.userBooks.length < 3){\n                $scope.checkBookLength = true;\n              }\n              if($scope.userBooks.length >= 3){\n                $scope.checkBookLength = false;\n              }\n            }\n          })\n      }\n\n      $scope.deleteBook = (book) => {\n        bookService.deleteBook(book)\n        .then((data) => { \n          let deletedbookId = data._id;\n          deletedBooks.push(deletedbookId);\n        })\n        .catch((err) => { console.error(err) })\n      }\n\n      $scope.close = function(){\n        $uibModalInstance.close({\n          message: \"closed\",\n          deleted: deletedBooks\n        });\n      };\n    }\n})();\n","(function () {\n\n  angular\n    .module('app')\n    .directive('orderDetailsBook', [orderDetailsBook]);\n\n  function orderDetailsBook() {\n\n    return {\n      restrict: 'A',\n      templateUrl: './app/components/admin/order-details/order-details-book-directive/order-details-book.html',\n      scope: true,\n      link: link\n    };\n\n    function link(scope, elem, attrs) {\n\n      scope.bookNumber = +attrs.bookNumber;\n\n    }\n\n  };\n})();","(function () {\n\n  angular\n    .module('app')\n    .directive('orderDetailsBookPage', [orderDetailsBookPage]);\n\n  function orderDetailsBookPage() {\n\n    return {\n      restrict: 'A',\n      templateUrl: './app/components/admin/order-details/order-details-book-directive/order-details-book-page-directive/order-details-book-page.html',\n      scope: true,\n      link: link\n    }\n\n    function link(scope, elem, attrs) {\n\n      let page = scope.page\n\n    }\n\n  };\n})();"]}